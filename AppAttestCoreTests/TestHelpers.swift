//
//  TestHelpers.swift
//  AppAttestCoreTests
//
//  Shared test helpers to avoid duplicating large attestation objects
//

import XCTest
@testable import AppAttestCore

enum TestHelpers {
    static let teamID = "M7PB4PDJAS"
    
    /// Loads the test attestation object from AppAttestCoreTests
    static func loadTestAttestation() throws -> AttestationObject {
        // Use the same attestation from AppAttestCoreTests
        let base64 = AppAttestCoreTests().attestationObjectBase64
        let data = try XCTUnwrap(Data(base64Encoded: base64))
        let decoder = AppAttestDecoder(teamID: teamID)
        return try decoder.decodeAttestationObject(data)
    }
    
    /// Creates a semantic model from the test attestation
    static func loadTestSemanticModel() throws -> AttestationSemanticModel {
        let attestation = try loadTestAttestation()
        return try attestation.buildSemanticModel()
    }
}

    /// Test attestation object base64 (shared across all tests)
    static let attestationObjectBase64 = """
    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
    """
    
    /// Loads the test attestation object
    static func loadTestAttestation() throws -> AttestationObject {
        let data = try XCTUnwrap(Data(base64Encoded: attestationObjectBase64))
        let decoder = AppAttestDecoder(teamID: teamID)
        return try decoder.decodeAttestationObject(data)
    }
